<!DOCTYPE html><html lang="cn"><head><meta charSet="UTF-8"/><title>第二章 | Network</title><meta name="viewport" content="width=device-width, initial-scale=1"/><meta property="og:title" content="第二章 | Network"/><meta name="description" content="Personal Blog"/><meta property="og:description" content="Personal Blog"/><meta property="og:type" content="website"/><meta property="twitter:card" content="summary_large_image"/><link rel="icon" type="image/x-icon" href="/favicon.ico"/><meta name="next-head-count" content="9"/><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/blog/_next/static/css/5f7c6aaf759aa20d.css" as="style"/><link rel="stylesheet" href="/blog/_next/static/css/5f7c6aaf759aa20d.css" data-n-g=""/><link rel="preload" href="/blog/_next/static/css/8c32e6301bbcfa7d.css" as="style"/><link rel="stylesheet" href="/blog/_next/static/css/8c32e6301bbcfa7d.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/blog/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/blog/_next/static/chunks/webpack-6965b024cefed38b.js" defer=""></script><script src="/blog/_next/static/chunks/framework-49c6cecf1f6d5795.js" defer=""></script><script src="/blog/_next/static/chunks/main-afe60a8753f56f38.js" defer=""></script><script src="/blog/_next/static/chunks/pages/_app-9c42418a99ee8f7c.js" defer=""></script><script src="/blog/_next/static/chunks/29107295-2a9ca7f07685bf37.js" defer=""></script><script src="/blog/_next/static/chunks/814c6784-3346a5f6227f5bd7.js" defer=""></script><script src="/blog/_next/static/chunks/664-fe029c8b38e64ec1.js" defer=""></script><script src="/blog/_next/static/chunks/487-2bcb96a49c3e8eaf.js" defer=""></script><script src="/blog/_next/static/chunks/675-6c30906122dcd831.js" defer=""></script><script src="/blog/_next/static/chunks/460-79a0e328949abe4b.js" defer=""></script><script src="/blog/_next/static/chunks/pages/%5Bcollection%5D/%5B...slug%5D-02c14713dcf67268.js" defer=""></script><script src="/blog/_next/static/yQwj-QREM4W24WvktILY8/_buildManifest.js" defer=""></script><script src="/blog/_next/static/yQwj-QREM4W24WvktILY8/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header data-theme="dark" class="style_nav-root__jrAJR" style="height:80px"><section class="style_nav-section__sS_tB"><a class="style_nav-logo__jRYAT" href="/blog"><h3>Allen Lee@Blog</h3></a><nav aria-label="Main" data-orientation="horizontal" dir="ltr" class="style_nav-menus__4aQM9"><div style="position:relative"><ul data-orientation="horizontal" dir="ltr"><li><button class="style_btn__AkQj7 style_subtle__i70rQ style_nav-trigger__ekUye" id="radix-:Rj6:-trigger-radix-:Rjj6:" data-state="closed" aria-expanded="false" aria-controls="radix-:Rj6:-content-radix-:Rjj6:" data-radix-collection-item="">Overview <svg stroke="currentColor" fill="none" stroke-width="0" viewBox="0 0 15 15" aria-hidden="true" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.18179 6.18181C4.35753 6.00608 4.64245 6.00608 4.81819 6.18181L7.49999 8.86362L10.1818 6.18181C10.3575 6.00608 10.6424 6.00608 10.8182 6.18181C10.9939 6.35755 10.9939 6.64247 10.8182 6.81821L7.81819 9.81821C7.73379 9.9026 7.61934 9.95001 7.49999 9.95001C7.38064 9.95001 7.26618 9.9026 7.18179 9.81821L4.18179 6.81821C4.00605 6.64247 4.00605 6.35755 4.18179 6.18181Z" fill="currentColor"></path></svg></button></li></ul></div></nav></section></header><main data-theme="light" style="background-color:var(--colorNeutralBackground1);overflow-x:hidden;overflow-y:auto;width:100vw;height:calc(100vh - 80px)" id="main"><div class="collection_slug_Root__xztwf"><div class="styles_netPost__eLnJE" style="max-width:960px;font-family:YaHei, Helvetica, arial, sans-serif;font-size:16px"><h1>第二章</h1><h3 style="margin:20px 0 10px" id="for-http">For Http<a class="anchor after" aria-hidden="true" aria-label="permalink" tabindex="-1" href="/blog/network/second#for-http"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" focusable="false"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a></h3>
<p></p>
<figure role="figure"><span class="resp-image-wrapper" style="display:flex;align-items:center;justify-content:center;position:relative"><a target="_blank" rel="noopener" style="display:block" href="/blog/images/network/fqdn.webp"><img crossorigin="anonymous" alt="FQDN" loading="lazy" width="641" height="347" decoding="async" data-nimg="1" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 641 347&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAACCAIAAADwyuo0AAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAI0lEQVR4nGPQ1tVTUlEVE5e0srFlePbs2YEjR5ctX7l+4yYAYqMK7vQWutcAAAAASUVORK5CYII=&#x27;/%3E%3C/svg%3E&quot;)" src="/blog/images/network/fqdn.webp"/></a></span><figcaption role="figcaption">FQDN</figcaption></figure>
<p>FQDN 总长度不超过 255 个字符，两个 . 之间的字符不超过 63 个</p>
<p>当连接到主机(例如，使用 SSH 客户机)时，必须指定 FQDN(与 URL 的区别是没有 protocal 和 resource)。然后，DNS 服务器通过查看其 DNS 表将主机名解析为其 IP 地址。与主机取得联系，您将收到一个登录提示</p>
<h3 style="margin:20px 0 10px" id="应用层协议原理">应用层协议原理<a class="anchor after" aria-hidden="true" aria-label="permalink" tabindex="-1" href="/blog/network/second#%E5%BA%94%E7%94%A8%E5%B1%82%E5%8D%8F%E8%AE%AE%E5%8E%9F%E7%90%86"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" focusable="false"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a></h3>
<p>应用程序由通信进程对组成。每对中的两个进程互相发送报文。进程通过**套接字(socket)**向网络发送或请求报文
</p>
<figure role="figure"><span class="resp-image-wrapper" style="display:flex;align-items:center;justify-content:center;position:relative"><a target="_blank" rel="noopener" style="display:block" href="/blog/images/network/application_layer.webp"><img crossorigin="anonymous" alt="application_layer" loading="lazy" width="717" height="286" decoding="async" data-nimg="1" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 717 286&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAACCAIAAADwyuo0AAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAIklEQVR4nGOIjQgyMtSJiAy7dOkCQ1iwlzAfGxszw+/f3wFtrwkiWQzHjwAAAABJRU5ErkJggg==&#x27;/%3E%3C/svg%3E&quot;)" src="/blog/images/network/application_layer.webp"/></a></span><figcaption role="figcaption">application_layer</figcaption></figure>
<p>
套接字是同一台主机内应用层和运输层之间的接口</p>
<p>SSL 是在应用层实现的，是对 TCP 的一种加强</p>
<p>为了寻址，因此主机由<strong>IP 地址</strong>标识；进程由**端口号(port number)**标识（<a rel="noopener noreferrer external nofollow" target="_blank" href="https://www.iana.org">固定端口参考</a>）</p>
<h3 style="margin:20px 0 10px" id="应用层协议">应用层协议<a class="anchor after" aria-hidden="true" aria-label="permalink" tabindex="-1" href="/blog/network/second#%E5%BA%94%E7%94%A8%E5%B1%82%E5%8D%8F%E8%AE%AE"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" focusable="false"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a></h3>
<p>**应用层协议(application-layer protocol)**定义了运行在不同端系统上的应用程序如何相互传递报文。</p>
<p>**非持续连接(non-persistent connection)**指每个请求/响应对是经一个单独的 TCP 连接发送</p>
<p>**持续连接(persistent connection)**指所有请求及响应经相同的 TCP 连接发送</p>
<h3 style="margin:20px 0 10px" id="dns">DNS<a class="anchor after" aria-hidden="true" aria-label="permalink" tabindex="-1" href="/blog/network/second#dns"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" focusable="false"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a></h3>
<p>用于将主机名解析为 ip 地址的服务</p>
<p>DNS 是</p>
<ol>
<li>一个由分层的*<strong>*DNS 服务器实现的</strong>分布式数据库**</li>
<li>一个使得主机能够查询分布式数据库的<strong>应用层协议</strong></li>
</ol>
<p>DNS 服务器通常是运行 BIND(Berkeley Internet Name Domain)软件的 UNIX 机器。DNS 协议运行在 UDP 之上，使用 53 端口</p>
<p><strong>递归查询</strong>指该查询以自己的名义请求；
<strong>迭代查询</strong>指所有回答都是直接返回其他 ip 地址</p>
<p>通常的查询都遵从：从请求主机到本地 dns 服务器的查询是递归的，其余查询是迭代的</p>
<h4 id="dns-记录和报文">DNS 记录和报文<a class="anchor after" aria-hidden="true" aria-label="permalink" tabindex="-1" href="/blog/network/second#dns-%E8%AE%B0%E5%BD%95%E5%92%8C%E6%8A%A5%E6%96%87"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" focusable="false"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a></h4>
<p>whois 数据库是所有已注册域名的列表</p>
<p>DNS 服务器存储了<strong>资源记录(Resource Record, RR)</strong>，RR 提供了主机名到 ip 地址的映射。RR 是一个四元组<code>(Name, Value, Type, TTL)</code></p>
<p>其中，TTL 指该记录的生存时间，决定了 RR 应该从缓存中删除的时间；Name 和 Value 的值取决于 Type</p>
<ul>
<li>若 Type=A, 则 Name 是主机名，Value 是其对应 ip</li>
<li>若 Type=NS, 则 Name 是个域，Value 是储存该域主机 ip 地址的权威 DNS 服务器的主机名</li>
<li>若 Type=CNAME, 则 Value 是别名为 Name 的主机对应的规范化主机名</li>
<li>若 Type=MX, 则 Value 是别名为 Name 的邮件服务器的规范化主机名</li>
</ul>
<p>DNS 只有查询和回答这两种报文，其格式相同
</p>
<figure role="figure"><span class="resp-image-wrapper" style="display:flex;align-items:center;justify-content:center;position:relative"><a target="_blank" rel="noopener" style="display:block" href="/blog/images/network/dns_message.webp"><img crossorigin="anonymous" alt="dns_message" loading="lazy" width="470" height="588" decoding="async" data-nimg="1" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 470 588&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAECAIAAADETxJQAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAMUlEQVR4nGMw1tfsaW+UEeNmWL5s4dP7t+2sDBkqygqXL1uYGB/N4OzoqKejlV+QAwAoXw6PiLydHwAAAABJRU5ErkJggg==&#x27;/%3E%3C/svg%3E&quot;)" src="/blog/images/network/dns_message.webp"/></a></span><figcaption role="figcaption">dns_message</figcaption></figure>
<p>
DNS 查询可以通过<code>nslookup</code>命令手动查询</p>
<p>DNS 中 RR 的增删由**注册登记机构(registrar)**控制，其由<a rel="noopener noreferrer external nofollow" target="_blank" href="https://www.internic.net">因特网名字和地址分配机构(Internet Corporation for Assigned Names and Numbers, ICANN)</a>授权</p>
<h3 style="margin:20px 0 10px" id="简单套接字编程">简单套接字编程<a class="anchor after" aria-hidden="true" aria-label="permalink" tabindex="-1" href="/blog/network/second#%E7%AE%80%E5%8D%95%E5%A5%97%E6%8E%A5%E5%AD%97%E7%BC%96%E7%A8%8B"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" focusable="false"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a></h3>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line line-number" line="1"><span class="token comment">#UDPClient.py</span>
</span><span class="code-line line-number" line="2"><span class="token keyword">from</span> socket <span class="token keyword">import</span> <span class="token operator">*</span>
</span><span class="code-line line-number" line="3">serverName <span class="token operator">=</span> <span class="token string">&quot;hostname&quot;</span><span class="token punctuation">;</span> serverPort <span class="token operator">=</span> <span class="token number">12000</span>
</span><span class="code-line line-number" line="4">clientSocket <span class="token operator">=</span> socket<span class="token punctuation">(</span>AF_INET<span class="token punctuation">,</span> SOCK_DGRAM<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="5">msg <span class="token operator">=</span> <span class="token builtin">raw_input</span><span class="token punctuation">(</span><span class="token string">&quot;input: &quot;</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="6">clientSocket<span class="token punctuation">.</span>sendto<span class="token punctuation">(</span>msg<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>serverName<span class="token punctuation">,</span> serverPort<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="7">modifiedMsg<span class="token punctuation">,</span> serverAdd <span class="token operator">=</span> clientSocket<span class="token punctuation">.</span>recvfrom<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="8"><span class="token keyword">print</span><span class="token punctuation">(</span>modifiedMsg<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="9">clientSocket<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="10">
</span><span class="code-line line-number" line="11"><span class="token comment">#UDPServer.py</span>
</span><span class="code-line line-number" line="12"><span class="token keyword">from</span> socket <span class="token keyword">import</span> <span class="token operator">*</span>
</span><span class="code-line line-number" line="13">serverPort <span class="token operator">=</span> <span class="token number">12000</span>
</span><span class="code-line line-number" line="14">serverSocket <span class="token operator">=</span> socket<span class="token punctuation">(</span>AF_INET<span class="token punctuation">,</span> SOCK_DGRAM<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="15">serverSocket<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> serverPort<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="16"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;server ready to receive&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="17"><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
</span><span class="code-line line-number" line="18">    msg<span class="token punctuation">,</span> clientAdd <span class="token operator">=</span> serverSocket<span class="token punctuation">.</span>recvfrom<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="19">    modifiedMsg <span class="token operator">=</span> msg<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="20">    serverSocket<span class="token punctuation">.</span>sendto<span class="token punctuation">(</span>modifiedMsg<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> clientAdd<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="21">
</span><span class="code-line line-number" line="22"><span class="token comment">#TCPClient.py</span>
</span><span class="code-line line-number" line="23">clientSocket <span class="token operator">=</span> socket<span class="token punctuation">(</span>AF_INIT<span class="token punctuation">,</span> SOCK_STREAM<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="24">clientSocket<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>serverName<span class="token punctuation">,</span> serverPort<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="25">clientSocket<span class="token punctuation">.</span>send<span class="token punctuation">(</span>msg<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="26">
</span><span class="code-line line-number" line="27"><span class="token comment">#TCPServer.py</span>
</span><span class="code-line line-number" line="28">serverSocket <span class="token operator">=</span> socket<span class="token punctuation">(</span>AF_INIT<span class="token punctuation">,</span> SOCK_STREAM<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="29">serverSocket<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> serverPort<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="30">serverSocket<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token builtin">max</span><span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="31"><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
</span><span class="code-line line-number" line="32">    connectSocket<span class="token punctuation">,</span> addr <span class="token operator">=</span> serverSocket<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="33">    msg <span class="token operator">=</span> connetSocket<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="34">    connectSocket<span class="token punctuation">.</span>send<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="35">    connectSocket<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"matter":{"date":"2018-01-24","title":"第二章","tags":["network"],"index":2},"absPath":"/home/runner/work/blog/blog/renderer/mdx/network/second.mdx","type":"mdx","slug":["second"],"collection":"network","url":"/network/second"},"compiled":{"content":"\"use strict\";\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst frontmatter = {\n  \"date\": \"2018-01-24\",\n  \"title\": \"第二章\",\n  \"tags\": [\"network\"],\n  \"index\": 2\n};\nfunction _createMdxContent(props) {\n  const _components = {\n    a: \"a\",\n    code: \"code\",\n    h3: \"h3\",\n    h4: \"h4\",\n    img: \"img\",\n    li: \"li\",\n    ol: \"ol\",\n    p: \"p\",\n    path: \"path\",\n    pre: \"pre\",\n    span: \"span\",\n    strong: \"strong\",\n    svg: \"svg\",\n    ul: \"ul\",\n    ...props.components\n  };\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.h3, {\n      id: \"for-http\",\n      children: [\"For Http\", _jsx(_components.a, {\n        className: \"anchor after\",\n        \"aria-hidden\": true,\n        \"aria-label\": \"permalink\",\n        tabIndex: \"-1\",\n        href: \"#for-http\",\n        children: _jsx(_components.svg, {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          viewBox: \"0 0 16 16\",\n          focusable: \"false\",\n          children: _jsx(_components.path, {\n            d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\",\n            fillRule: \"evenodd\"\n          })\n        })\n      })]\n    }), \"\\n\", _jsx(_components.p, {}), \"\\n\", _jsx(_components.img, {\n      src: \"/images/network/fqdn.webp\",\n      alt: \"FQDN\",\n      width: \"641\",\n      height: \"347\",\n      sizes: \"(max-width: 641px) 100vw, 347px\",\n      blurDataURL: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAACCAIAAADwyuo0AAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAI0lEQVR4nGPQ1tVTUlEVE5e0srFlePbs2YEjR5ctX7l+4yYAYqMK7vQWutcAAAAASUVORK5CYII=\",\n      placeholder: \"blur\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"FQDN 总长度不超过 255 个字符，两个 . 之间的字符不超过 63 个\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"当连接到主机(例如，使用 SSH 客户机)时，必须指定 FQDN(与 URL 的区别是没有 protocal 和 resource)。然后，DNS 服务器通过查看其 DNS 表将主机名解析为其 IP 地址。与主机取得联系，您将收到一个登录提示\"\n    }), \"\\n\", _jsxs(_components.h3, {\n      id: \"应用层协议原理\",\n      children: [\"应用层协议原理\", _jsx(_components.a, {\n        className: \"anchor after\",\n        \"aria-hidden\": true,\n        \"aria-label\": \"permalink\",\n        tabIndex: \"-1\",\n        href: \"#应用层协议原理\",\n        children: _jsx(_components.svg, {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          viewBox: \"0 0 16 16\",\n          focusable: \"false\",\n          children: _jsx(_components.path, {\n            d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\",\n            fillRule: \"evenodd\"\n          })\n        })\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"应用程序由通信进程对组成。每对中的两个进程互相发送报文。进程通过**套接字(socket)**向网络发送或请求报文\\n\"\n    }), \"\\n\", _jsx(_components.img, {\n      src: \"/images/network/application_layer.webp\",\n      alt: \"application_layer\",\n      width: \"717\",\n      height: \"286\",\n      sizes: \"(max-width: 717px) 100vw, 286px\",\n      blurDataURL: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAACCAIAAADwyuo0AAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAIklEQVR4nGOIjQgyMtSJiAy7dOkCQ1iwlzAfGxszw+/f3wFtrwkiWQzHjwAAAABJRU5ErkJggg==\",\n      placeholder: \"blur\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"\\n套接字是同一台主机内应用层和运输层之间的接口\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"SSL 是在应用层实现的，是对 TCP 的一种加强\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"为了寻址，因此主机由\", _jsx(_components.strong, {\n        children: \"IP 地址\"\n      }), \"标识；进程由**端口号(port number)**标识（\", _jsx(_components.a, {\n        href: \"https://www.iana.org\",\n        children: \"固定端口参考\"\n      }), \"）\"]\n    }), \"\\n\", _jsxs(_components.h3, {\n      id: \"应用层协议\",\n      children: [\"应用层协议\", _jsx(_components.a, {\n        className: \"anchor after\",\n        \"aria-hidden\": true,\n        \"aria-label\": \"permalink\",\n        tabIndex: \"-1\",\n        href: \"#应用层协议\",\n        children: _jsx(_components.svg, {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          viewBox: \"0 0 16 16\",\n          focusable: \"false\",\n          children: _jsx(_components.path, {\n            d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\",\n            fillRule: \"evenodd\"\n          })\n        })\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"**应用层协议(application-layer protocol)**定义了运行在不同端系统上的应用程序如何相互传递报文。\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"**非持续连接(non-persistent connection)**指每个请求/响应对是经一个单独的 TCP 连接发送\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"**持续连接(persistent connection)**指所有请求及响应经相同的 TCP 连接发送\"\n    }), \"\\n\", _jsxs(_components.h3, {\n      id: \"dns\",\n      children: [\"DNS\", _jsx(_components.a, {\n        className: \"anchor after\",\n        \"aria-hidden\": true,\n        \"aria-label\": \"permalink\",\n        tabIndex: \"-1\",\n        href: \"#dns\",\n        children: _jsx(_components.svg, {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          viewBox: \"0 0 16 16\",\n          focusable: \"false\",\n          children: _jsx(_components.path, {\n            d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\",\n            fillRule: \"evenodd\"\n          })\n        })\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"用于将主机名解析为 ip 地址的服务\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"DNS 是\"\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"一个由分层的*\", _jsx(_components.strong, {\n          children: \"*DNS 服务器实现的\"\n        }), \"分布式数据库**\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"一个使得主机能够查询分布式数据库的\", _jsx(_components.strong, {\n          children: \"应用层协议\"\n        })]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"DNS 服务器通常是运行 BIND(Berkeley Internet Name Domain)软件的 UNIX 机器。DNS 协议运行在 UDP 之上，使用 53 端口\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"递归查询\"\n      }), \"指该查询以自己的名义请求；\\n\", _jsx(_components.strong, {\n        children: \"迭代查询\"\n      }), \"指所有回答都是直接返回其他 ip 地址\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"通常的查询都遵从：从请求主机到本地 dns 服务器的查询是递归的，其余查询是迭代的\"\n    }), \"\\n\", _jsxs(_components.h4, {\n      id: \"dns-记录和报文\",\n      children: [\"DNS 记录和报文\", _jsx(_components.a, {\n        className: \"anchor after\",\n        \"aria-hidden\": true,\n        \"aria-label\": \"permalink\",\n        tabIndex: \"-1\",\n        href: \"#dns-记录和报文\",\n        children: _jsx(_components.svg, {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          viewBox: \"0 0 16 16\",\n          focusable: \"false\",\n          children: _jsx(_components.path, {\n            d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\",\n            fillRule: \"evenodd\"\n          })\n        })\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"whois 数据库是所有已注册域名的列表\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"DNS 服务器存储了\", _jsx(_components.strong, {\n        children: \"资源记录(Resource Record, RR)\"\n      }), \"，RR 提供了主机名到 ip 地址的映射。RR 是一个四元组\", _jsx(_components.code, {\n        children: \"(Name, Value, Type, TTL)\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"其中，TTL 指该记录的生存时间，决定了 RR 应该从缓存中删除的时间；Name 和 Value 的值取决于 Type\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"若 Type=A, 则 Name 是主机名，Value 是其对应 ip\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"若 Type=NS, 则 Name 是个域，Value 是储存该域主机 ip 地址的权威 DNS 服务器的主机名\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"若 Type=CNAME, 则 Value 是别名为 Name 的主机对应的规范化主机名\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"若 Type=MX, 则 Value 是别名为 Name 的邮件服务器的规范化主机名\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"DNS 只有查询和回答这两种报文，其格式相同\\n\"\n    }), \"\\n\", _jsx(_components.img, {\n      src: \"/images/network/dns_message.webp\",\n      alt: \"dns_message\",\n      width: \"470\",\n      height: \"588\",\n      sizes: \"(max-width: 470px) 100vw, 588px\",\n      blurDataURL: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAECAIAAADETxJQAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAMUlEQVR4nGMw1tfsaW+UEeNmWL5s4dP7t+2sDBkqygqXL1uYGB/N4OzoqKejlV+QAwAoXw6PiLydHwAAAABJRU5ErkJggg==\",\n      placeholder: \"blur\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"\\nDNS 查询可以通过\", _jsx(_components.code, {\n        children: \"nslookup\"\n      }), \"命令手动查询\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"DNS 中 RR 的增删由**注册登记机构(registrar)**控制，其由\", _jsx(_components.a, {\n        href: \"https://www.internic.net\",\n        children: \"因特网名字和地址分配机构(Internet Corporation for Assigned Names and Numbers, ICANN)\"\n      }), \"授权\"]\n    }), \"\\n\", _jsxs(_components.h3, {\n      id: \"简单套接字编程\",\n      children: [\"简单套接字编程\", _jsx(_components.a, {\n        className: \"anchor after\",\n        \"aria-hidden\": true,\n        \"aria-label\": \"permalink\",\n        tabIndex: \"-1\",\n        href: \"#简单套接字编程\",\n        children: _jsx(_components.svg, {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          viewBox: \"0 0 16 16\",\n          focusable: \"false\",\n          children: _jsx(_components.path, {\n            d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\",\n            fillRule: \"evenodd\"\n          })\n        })\n      })]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"1\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"#UDPClient.py\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"2\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"from\"\n          }), \" socket \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"import\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"3\",\n          children: [\"serverName \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"hostname\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \";\"\n          }), \" serverPort \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"12000\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"4\",\n          children: [\"clientSocket \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" socket\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"AF_INET\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" SOCK_DGRAM\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"5\",\n          children: [\"msg \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"raw_input\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"input: \\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"6\",\n          children: [\"clientSocket\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"sendto\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"msg\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"encode\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"serverName\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" serverPort\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"7\",\n          children: [\"modifiedMsg\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" serverAdd \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" clientSocket\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"recvfrom\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2048\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"8\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"print\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"modifiedMsg\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"decode\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"9\",\n          children: [\"clientSocket\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"close\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line line-number\",\n          line: \"10\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"11\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"#UDPServer.py\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"12\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"from\"\n          }), \" socket \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"import\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"13\",\n          children: [\"serverPort \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"12000\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"14\",\n          children: [\"serverSocket \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" socket\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"AF_INET\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" SOCK_DGRAM\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"15\",\n          children: [\"serverSocket\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"bind\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" serverPort\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"16\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"print\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"server ready to receive\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"17\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"while\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"True\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"18\",\n          children: [\"    msg\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" clientAdd \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" serverSocket\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"recvfrom\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2048\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"19\",\n          children: [\"    modifiedMsg \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" msg\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"decode\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"upper\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"20\",\n          children: [\"    serverSocket\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"sendto\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"modifiedMsg\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"encode\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" clientAdd\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line line-number\",\n          line: \"21\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"22\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"#TCPClient.py\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"23\",\n          children: [\"clientSocket \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" socket\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"AF_INIT\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" SOCK_STREAM\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"24\",\n          children: [\"clientSocket\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"connect\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"serverName\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" serverPort\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"25\",\n          children: [\"clientSocket\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"send\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"msg\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"encode\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line line-number\",\n          line: \"26\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"27\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"#TCPServer.py\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"28\",\n          children: [\"serverSocket \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" socket\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"AF_INIT\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" SOCK_STREAM\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"29\",\n          children: [\"serverSocket\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"bind\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" serverPort\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"30\",\n          children: [\"serverSocket\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"listen\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"max\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"31\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"while\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"True\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"32\",\n          children: [\"    connectSocket\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" addr \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" serverSocket\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"accept\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"33\",\n          children: [\"    msg \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" connetSocket\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"recv\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1024\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"decode\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"upper\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"encode\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"34\",\n          children: [\"    connectSocket\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"send\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"msg\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line line-number\",\n          line: \"35\",\n          children: [\"    connectSocket\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"close\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = props.components || ({});\n  return MDXLayout ? _jsx(MDXLayout, {\n    ...props,\n    children: _jsx(_createMdxContent, {\n      ...props\n    })\n  }) : _createMdxContent(props);\n}\nreturn {\n  frontmatter,\n  default: MDXContent\n};\n","toc":[{"depth":3,"value":"For Http","id":"for-http"},{"depth":3,"value":"应用层协议原理","id":"应用层协议原理"},{"depth":3,"value":"应用层协议","id":"应用层协议"},{"depth":3,"value":"DNS","id":"dns","children":[{"depth":4,"value":"DNS 记录和报文","id":"dns-记录和报文"}]},{"depth":3,"value":"简单套接字编程","id":"简单套接字编程"}]},"overview":[{"length":22,"name":"archive"},{"length":15,"name":"graphics"},{"length":1,"name":"math"},{"length":8,"name":"network"}]},"__N_SSG":true},"page":"/[collection]/[...slug]","query":{"collection":"network","slug":["second"]},"buildId":"yQwj-QREM4W24WvktILY8","assetPrefix":"/blog","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>