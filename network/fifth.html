<!DOCTYPE html><html lang="cn"><head><meta charSet="UTF-8"/><title>第五章 | Network</title><meta name="viewport" content="width=device-width, initial-scale=1"/><meta property="og:title" content="第五章 | Network"/><meta name="description" content="Personal Blog"/><meta property="og:description" content="Personal Blog"/><meta property="og:type" content="website"/><meta property="twitter:card" content="summary_large_image"/><link rel="icon" type="image/x-icon" href="/favicon.ico"/><meta name="next-head-count" content="9"/><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/blog/_next/static/css/188c649415dfc8d9.css" as="style"/><link rel="stylesheet" href="/blog/_next/static/css/188c649415dfc8d9.css" data-n-g=""/><link rel="preload" href="/blog/_next/static/css/819e775b5b3a36e7.css" as="style"/><link rel="stylesheet" href="/blog/_next/static/css/819e775b5b3a36e7.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/blog/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/blog/_next/static/chunks/webpack-0921f57b79154458.js" defer=""></script><script src="/blog/_next/static/chunks/framework-66d32731bdd20e83.js" defer=""></script><script src="/blog/_next/static/chunks/main-8aeaea97487321ec.js" defer=""></script><script src="/blog/_next/static/chunks/pages/_app-ccbaf05611d69494.js" defer=""></script><script src="/blog/_next/static/chunks/29107295-2a9ca7f07685bf37.js" defer=""></script><script src="/blog/_next/static/chunks/814c6784-d7d96a807e1f8484.js" defer=""></script><script src="/blog/_next/static/chunks/664-2906cfc365be3e0b.js" defer=""></script><script src="/blog/_next/static/chunks/158-8b1385307a27c215.js" defer=""></script><script src="/blog/_next/static/chunks/675-dbb4e92c9bdf5be6.js" defer=""></script><script src="/blog/_next/static/chunks/460-c6727053c0ccd6ae.js" defer=""></script><script src="/blog/_next/static/chunks/pages/%5Bcollection%5D/%5B...slug%5D-163f78c8f70614ab.js" defer=""></script><script src="/blog/_next/static/meNayWSLCpwIRBFSyCCZM/_buildManifest.js" defer=""></script><script src="/blog/_next/static/meNayWSLCpwIRBFSyCCZM/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header data-theme="dark" class="style_nav-root__jrAJR" style="height:80px"><section class="style_nav-section__sS_tB"><a class="style_nav-logo__jRYAT" href="/blog"><h3>Allen Lee@Blog</h3></a><nav aria-label="Main" data-orientation="horizontal" dir="ltr" class="style_nav-menus__4aQM9"><div style="position:relative"><ul data-orientation="horizontal" dir="ltr"><li><button class="style_btn__AkQj7 style_subtle__i70rQ style_nav-trigger__ekUye" id="radix-:Rj6:-trigger-radix-:Rjj6:" data-state="closed" aria-expanded="false" aria-controls="radix-:Rj6:-content-radix-:Rjj6:" data-radix-collection-item="">Overview <svg stroke="currentColor" fill="none" stroke-width="0" viewBox="0 0 15 15" aria-hidden="true" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.18179 6.18181C4.35753 6.00608 4.64245 6.00608 4.81819 6.18181L7.49999 8.86362L10.1818 6.18181C10.3575 6.00608 10.6424 6.00608 10.8182 6.18181C10.9939 6.35755 10.9939 6.64247 10.8182 6.81821L7.81819 9.81821C7.73379 9.9026 7.61934 9.95001 7.49999 9.95001C7.38064 9.95001 7.26618 9.9026 7.18179 9.81821L4.18179 6.81821C4.00605 6.64247 4.00605 6.35755 4.18179 6.18181Z" fill="currentColor"></path></svg></button></li></ul></div></nav></section></header><main data-theme="light" style="background-color:var(--colorNeutralBackground1);overflow-x:hidden;overflow-y:auto;width:100vw;height:calc(100vh - 80px)" id="main"><div class="collection_slug_Root__xztwf"><div class="styles_netPost__eLnJE" style="max-width:960px;font-family:YaHei, Helvetica, arial, sans-serif;font-size:16px"><h1>第五章</h1><h2 id="路由选择算法">路由选择算法<a rel="noopener noreferrer external nofollow" target="_blank" href="#路由选择算法" class="anchor after" aria-hidden="true" aria-label="permalink" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" focusable="false"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a></h2>
<p></p>
<figure role="figure"><span class="resp-image-wrapper" style="display:flex;align-items:center;justify-content:center;position:relative"><a target="_blank" rel="noopener" style="display:block" href="/blog/images/network/a_net_abstract_model.webp"><img crossorigin="anonymous" alt="a_net_abstract_model" loading="lazy" width="525" height="467" decoding="async" data-nimg="1" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 525 467&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAIAAAAmkwkpAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAP0lEQVR4nAE0AMv/APDx7qSloZKRiY2MggCYmJSCgH5cWFQzMiwAqqqkdXJvS0pFEg0EAPf28cK9toyIfhULAazCF+8ueHugAAAAAElFTkSuQmCC&#x27;/%3E%3C/svg%3E&quot;)" src="/blog/images/network/a_net_abstract_model.webp"/></a></span><figcaption role="figcaption">a_net_abstract_model</figcaption></figure>
<p>
**路由选择算法(routing algorithm)**的目的是确定网络中一个源到目的地之间的最低开销路径</p>
<p>通常划分为</p>
<ul>
<li><strong>集中式(centralized)路由选择算法</strong>，需要提前确定所有路径上的开销，典型的如<strong>链路状态(Link State, LS)算法</strong></li>
<li><strong>分散式(decentralized)路由选择算法</strong>，每个路由器通过迭代、分布式的计算出所需路径，典型的如<strong>距离向量(Distance-Vector, DV)算法</strong></li>
</ul>
<p>另外还可以分为**静态(static)<strong>和</strong>动态(dynamic)**路由选择算法、**负载明感(load-sensitive)<strong>和</strong>负载迟钝(load-insensitive)**算法</p>
<h2 id="as">AS<a rel="noopener noreferrer external nofollow" target="_blank" href="#as" class="anchor after" aria-hidden="true" aria-label="permalink" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" focusable="false"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a></h2>
<p>**自治系统(Autonomous System, AS)**由一组在相同管理控制下的路由器组成，目的是为了减少路由选择算法的规模，每个 AS 由全局唯一的 AS 号标识，其由 ICANN 区域注册机构分配</p>
<p>在同一个 AS 中运行的路由选择算法叫做<strong>自治系统内部路由选择协议(intra-autonomous system routing protocol)</strong></p>
<p>**开放最短路优先(OSPF)**是一种 AS 内部的 LS 算法，使用洪泛链路状态信息和 Dijkstra 算法，其中的开销由管理员配置。其通告包含在 OSPF 报文中，由 IP 承载，上层协议值为 89</p>
<p><strong>RIP 协议(Routing Information Protocol, 路由信息协议)</strong>，基于距离向量算法，适用于小型同类网络。其通过广播 UDP 报文(520)来交换路由信息，每 30 秒发送一次路由信息更新。使用<strong>跳跃计数(hop count)</strong>(一个包到达目标所必须经过的路由器的数目)作为尺度来衡量路由距离。只要跳跃计数相同，RIP 则认为两个路由是等距离的。RIP 最多支持的跳数为 15，16 为不可达</p>
<p><strong>IS-IS(Intermediate System-to-Intermediate System，中间系统到中间系统)协议</strong>，使用最短路径优先算法，其定义较为复杂，具体参考：<a rel="noopener noreferrer external nofollow" target="_blank" href="https://blog.51cto.com/wt7315/2085071">详细笔记 1</a>/<a rel="noopener noreferrer external nofollow" target="_blank" href="https://baike.baidu.com/item/is-is">详细笔记 2</a></p>
<p>用于在 AS 间的路径选择协议，称为<strong>自治系统间路由协议(inter-autonomous system routing protocol)</strong>。全球 AS 通用的协议是<strong>边际网关协议(Broder Geteway Protocol, BGP)</strong></p>
<p>BGP 采用距离向量算法</p>
<p>BGP 有两个作用</p>
<ol>
<li>通告某个 IP 地址的存在。BGP 使用 179 端口的半永久 tcp 连接交换路由信息。每条直接连接及其发送的 BGP 报文称为<strong>BGP 连接</strong>。跨越 AS 的 BGP 连接(外部 BGP 连接, eBGP)的两个路由器称为<strong>网关路由器(geteway router)</strong>，其他的称为**内部路由器(internal router)**其连接叫内部 BGP 连接(iBGP)</li>
<li>路由选择。在通告时，BGP 将报告<strong>BGP 属性</strong>，其中重要内容有：AS-PATH(已经通过的 AS 列表)和 NEXT-HOP(AS-PATH 的起始路由器接口地址)。BGP 的路由选择算法基于<strong>热土豆路由选择(hot potato routing)</strong></li>
</ol>
<p>BGP 还用于实现<strong>IP 任播(anycast)服务</strong>。该服务通常处于 DNS 中，用于 ① 替换不同服务器上的相同内容 ② 让用户从最近的服务器访问内容</p>
<h2 id="sdn-软件定义网络">SDN 软件定义网络<a rel="noopener noreferrer external nofollow" target="_blank" href="#sdn-软件定义网络" class="anchor after" aria-hidden="true" aria-label="permalink" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" focusable="false"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a></h2>
<p></p>
<figure role="figure"><span class="resp-image-wrapper" style="display:flex;align-items:center;justify-content:center;position:relative"><a target="_blank" rel="noopener" style="display:block" href="/blog/images/network/sdn.webp"><img crossorigin="anonymous" alt="sdn" loading="lazy" width="655" height="557" decoding="async" data-nimg="1" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 655 557&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAIAAAA7ljmRAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAMklEQVR4nAEnANj/AOfj3OPd17KtpzMvKQD9+vjRz8rFwLs3MCwA4uLivr27enh2DgQA6McWUQS+QD8AAAAASUVORK5CYII=&#x27;/%3E%3C/svg%3E&quot;)" src="/blog/images/network/sdn.webp"/></a></span><figcaption role="figcaption">sdn</figcaption></figure>
<p>
通用转发表，通过<em>匹配+动作</em>的范式，对协议栈多个首部内容进行<em>匹配</em>，从而做到转发、负载均衡、防火墙等<em>动作</em>，是一般化的“分组交换机”</p>
<p>通用转发表经典标准为 OpenFlow，其表称为<strong>流表(flow table)</strong></p>
<p>SDN 采用可编程的网络，使得可以通过 SDN 控制器的 API 来定义和控制网络设备</p>
<h2 id="icmp">ICMP<a rel="noopener noreferrer external nofollow" target="_blank" href="#icmp" class="anchor after" aria-hidden="true" aria-label="permalink" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" focusable="false"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a></h2>
<p>**因特网控制报文协议(ICMP)**用于端系统和路由器之间沟通网络层的信息，典型用途是差错报告</p>
<p>ICMP 是作为 IP 载荷所承载，但其位于网络层
</p>
<figure role="figure"><span class="resp-image-wrapper" style="display:flex;align-items:center;justify-content:center;position:relative"><a target="_blank" rel="noopener" style="display:block" href="/blog/images/network/icmp_messages_type.webp"><img crossorigin="anonymous" alt="icmp_messages_type" loading="lazy" width="511" height="487" decoding="async" data-nimg="1" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 511 487&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAIAAAAmkwkpAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAPUlEQVR4nGP49OF1Q32lt7ebt7cHw///v1qb642NDc3NTRj+//9bUlIoLy+rqqrM8PTpY29vD25edmlpSQB2+RTNQNe7mQAAAABJRU5ErkJggg==&#x27;/%3E%3C/svg%3E&quot;)" src="/blog/images/network/icmp_messages_type.webp"/></a></span><figcaption role="figcaption">icmp_messages_type</figcaption></figure>
<p>
在 ICMPv6 中，添加了 IPv6 所需的类型和编码，如“分组太大”等</p>
<h2 id="网络管理和-snmp">网络管理和 SNMP<a rel="noopener noreferrer external nofollow" target="_blank" href="#网络管理和-snmp" class="anchor after" aria-hidden="true" aria-label="permalink" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" focusable="false"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a></h2>
<p></p>
<figure role="figure"><span class="resp-image-wrapper" style="display:flex;align-items:center;justify-content:center;position:relative"><a target="_blank" rel="noopener" style="display:block" href="/blog/images/network/network_managed.webp"><img crossorigin="anonymous" alt="network_managed" loading="lazy" width="906" height="671" decoding="async" data-nimg="1" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 906 671&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAIAAAA7ljmRAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAMklEQVR4nAEnANj/AElHRuHa07u2rxYSDgCln5X/9u65sKk+ODIAYllQwbSry7+1eW1hgNUT4gF7+eQAAAAASUVORK5CYII=&#x27;/%3E%3C/svg%3E&quot;)" src="/blog/images/network/network_managed.webp"/></a></span><figcaption role="figcaption">network_managed</figcaption></figure>
<p>
<strong>被管设备(managed device)<strong>中的每个</strong>被管对象(managed object, 如网卡/协议内容等)<strong>通过</strong>网络管理代理(network management agent)<strong>与</strong>管理服务器</strong>通信，之后被存储在**管理信息库(Management Information Base, MIB)**中</p>
<p>MIB 对象由数据描述语言 SMI(Structure of Management Information)所定义，收集在 MIB 模块中</p>
<p>代理和服务器之间使用<strong>网络管理协议(network management protocol)<strong>通信，典型的如</strong>简单网络管理协议(Simple Network Management Protocol, SNMP)</strong></p>
<p>SNMP 是应用层协议其报文通常称为协议数据单元(PDU)，基于 UDP，通常有两种模式：① 请求响应，服务器请求，代理响应；② 异常陷阱，代理指示异常
</p>
<figure role="figure"><span class="resp-image-wrapper" style="display:flex;align-items:center;justify-content:center;position:relative"><a target="_blank" rel="noopener" style="display:block" href="/blog/images/network/pdu_of_snmp.webp"><img crossorigin="anonymous" alt="pdu_of_snmp" loading="lazy" width="800" height="639" decoding="async" data-nimg="1" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 800 639&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAIAAAA7ljmRAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAL0lEQVR4nGMQFBS0tbHYt2XV6zvnGSQlJaWlJE4e2Pn/0xMQh4uL7dDeTf9/vgMAHq0QwoprbgoAAAAASUVORK5CYII=&#x27;/%3E%3C/svg%3E&quot;)" src="/blog/images/network/pdu_of_snmp.webp"/></a></span><figcaption role="figcaption">pdu_of_snmp</figcaption></figure></div></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"matter":{"date":"2018-01-27","title":"第五章","tags":["network"],"index":5},"absPath":"/home/runner/work/blog/blog/renderer/mdx/network/fifth.mdx","type":"mdx","slug":["fifth"],"collection":"network","url":"/network/fifth"},"compiled":{"content":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst date = \"2018-01-27\", title = \"第五章\", tags = [\"network\"], index = 5;\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    h2: \"h2\",\n    a: \"a\",\n    svg: \"svg\",\n    path: \"path\",\n    p: \"p\",\n    img: \"img\",\n    ul: \"ul\",\n    li: \"li\",\n    strong: \"strong\",\n    ol: \"ol\",\n    em: \"em\"\n  }, props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.h2, {\n      id: \"路由选择算法\",\n      children: [\"路由选择算法\", _jsx(_components.a, {\n        className: \"anchor after\",\n        \"aria-hidden\": true,\n        \"aria-label\": \"permalink\",\n        tabIndex: \"-1\",\n        href: \"#路由选择算法\",\n        children: _jsx(_components.svg, {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          viewBox: \"0 0 16 16\",\n          focusable: \"false\",\n          children: _jsx(_components.path, {\n            d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\",\n            fillRule: \"evenodd\"\n          })\n        })\n      })]\n    }), \"\\n\", _jsx(_components.p, {}), \"\\n\", _jsx(_components.img, {\n      src: \"/images/network/a_net_abstract_model.webp\",\n      alt: \"a_net_abstract_model\",\n      width: \"525\",\n      height: \"467\",\n      sizes: \"(max-width: 525px) 100vw, 467px\",\n      blurDataURL: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAIAAAAmkwkpAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAP0lEQVR4nAE0AMv/APDx7qSloZKRiY2MggCYmJSCgH5cWFQzMiwAqqqkdXJvS0pFEg0EAPf28cK9toyIfhULAazCF+8ueHugAAAAAElFTkSuQmCC\",\n      placeholder: \"blur\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"\\n**路由选择算法(routing algorithm)**的目的是确定网络中一个源到目的地之间的最低开销路径\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"通常划分为\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"集中式(centralized)路由选择算法\"\n        }), \"，需要提前确定所有路径上的开销，典型的如\", _jsx(_components.strong, {\n          children: \"链路状态(Link State, LS)算法\"\n        })]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"分散式(decentralized)路由选择算法\"\n        }), \"，每个路由器通过迭代、分布式的计算出所需路径，典型的如\", _jsx(_components.strong, {\n          children: \"距离向量(Distance-Vector, DV)算法\"\n        })]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"另外还可以分为**静态(static)\", _jsx(_components.strong, {\n        children: \"和\"\n      }), \"动态(dynamic)**路由选择算法、**负载明感(load-sensitive)\", _jsx(_components.strong, {\n        children: \"和\"\n      }), \"负载迟钝(load-insensitive)**算法\"]\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"as\",\n      children: [\"AS\", _jsx(_components.a, {\n        className: \"anchor after\",\n        \"aria-hidden\": true,\n        \"aria-label\": \"permalink\",\n        tabIndex: \"-1\",\n        href: \"#as\",\n        children: _jsx(_components.svg, {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          viewBox: \"0 0 16 16\",\n          focusable: \"false\",\n          children: _jsx(_components.path, {\n            d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\",\n            fillRule: \"evenodd\"\n          })\n        })\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"**自治系统(Autonomous System, AS)**由一组在相同管理控制下的路由器组成，目的是为了减少路由选择算法的规模，每个 AS 由全局唯一的 AS 号标识，其由 ICANN 区域注册机构分配\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"在同一个 AS 中运行的路由选择算法叫做\", _jsx(_components.strong, {\n        children: \"自治系统内部路由选择协议(intra-autonomous system routing protocol)\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"**开放最短路优先(OSPF)**是一种 AS 内部的 LS 算法，使用洪泛链路状态信息和 Dijkstra 算法，其中的开销由管理员配置。其通告包含在 OSPF 报文中，由 IP 承载，上层协议值为 89\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"RIP 协议(Routing Information Protocol, 路由信息协议)\"\n      }), \"，基于距离向量算法，适用于小型同类网络。其通过广播 UDP 报文(520)来交换路由信息，每 30 秒发送一次路由信息更新。使用\", _jsx(_components.strong, {\n        children: \"跳跃计数(hop count)\"\n      }), \"(一个包到达目标所必须经过的路由器的数目)作为尺度来衡量路由距离。只要跳跃计数相同，RIP 则认为两个路由是等距离的。RIP 最多支持的跳数为 15，16 为不可达\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"IS-IS(Intermediate System-to-Intermediate System，中间系统到中间系统)协议\"\n      }), \"，使用最短路径优先算法，其定义较为复杂，具体参考：\", _jsx(_components.a, {\n        href: \"https://blog.51cto.com/wt7315/2085071\",\n        children: \"详细笔记 1\"\n      }), \"/\", _jsx(_components.a, {\n        href: \"https://baike.baidu.com/item/is-is\",\n        children: \"详细笔记 2\"\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"用于在 AS 间的路径选择协议，称为\", _jsx(_components.strong, {\n        children: \"自治系统间路由协议(inter-autonomous system routing protocol)\"\n      }), \"。全球 AS 通用的协议是\", _jsx(_components.strong, {\n        children: \"边际网关协议(Broder Geteway Protocol, BGP)\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"BGP 采用距离向量算法\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"BGP 有两个作用\"\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"通告某个 IP 地址的存在。BGP 使用 179 端口的半永久 tcp 连接交换路由信息。每条直接连接及其发送的 BGP 报文称为\", _jsx(_components.strong, {\n          children: \"BGP 连接\"\n        }), \"。跨越 AS 的 BGP 连接(外部 BGP 连接, eBGP)的两个路由器称为\", _jsx(_components.strong, {\n          children: \"网关路由器(geteway router)\"\n        }), \"，其他的称为**内部路由器(internal router)**其连接叫内部 BGP 连接(iBGP)\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"路由选择。在通告时，BGP 将报告\", _jsx(_components.strong, {\n          children: \"BGP 属性\"\n        }), \"，其中重要内容有：AS-PATH(已经通过的 AS 列表)和 NEXT-HOP(AS-PATH 的起始路由器接口地址)。BGP 的路由选择算法基于\", _jsx(_components.strong, {\n          children: \"热土豆路由选择(hot potato routing)\"\n        })]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"BGP 还用于实现\", _jsx(_components.strong, {\n        children: \"IP 任播(anycast)服务\"\n      }), \"。该服务通常处于 DNS 中，用于 ① 替换不同服务器上的相同内容 ② 让用户从最近的服务器访问内容\"]\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"sdn-软件定义网络\",\n      children: [\"SDN 软件定义网络\", _jsx(_components.a, {\n        className: \"anchor after\",\n        \"aria-hidden\": true,\n        \"aria-label\": \"permalink\",\n        tabIndex: \"-1\",\n        href: \"#sdn-软件定义网络\",\n        children: _jsx(_components.svg, {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          viewBox: \"0 0 16 16\",\n          focusable: \"false\",\n          children: _jsx(_components.path, {\n            d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\",\n            fillRule: \"evenodd\"\n          })\n        })\n      })]\n    }), \"\\n\", _jsx(_components.p, {}), \"\\n\", _jsx(_components.img, {\n      src: \"/images/network/sdn.webp\",\n      alt: \"sdn\",\n      width: \"655\",\n      height: \"557\",\n      sizes: \"(max-width: 655px) 100vw, 557px\",\n      blurDataURL: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAIAAAA7ljmRAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAMklEQVR4nAEnANj/AOfj3OPd17KtpzMvKQD9+vjRz8rFwLs3MCwA4uLivr27enh2DgQA6McWUQS+QD8AAAAASUVORK5CYII=\",\n      placeholder: \"blur\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"\\n通用转发表，通过\", _jsx(_components.em, {\n        children: \"匹配+动作\"\n      }), \"的范式，对协议栈多个首部内容进行\", _jsx(_components.em, {\n        children: \"匹配\"\n      }), \"，从而做到转发、负载均衡、防火墙等\", _jsx(_components.em, {\n        children: \"动作\"\n      }), \"，是一般化的“分组交换机”\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"通用转发表经典标准为 OpenFlow，其表称为\", _jsx(_components.strong, {\n        children: \"流表(flow table)\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"SDN 采用可编程的网络，使得可以通过 SDN 控制器的 API 来定义和控制网络设备\"\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"icmp\",\n      children: [\"ICMP\", _jsx(_components.a, {\n        className: \"anchor after\",\n        \"aria-hidden\": true,\n        \"aria-label\": \"permalink\",\n        tabIndex: \"-1\",\n        href: \"#icmp\",\n        children: _jsx(_components.svg, {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          viewBox: \"0 0 16 16\",\n          focusable: \"false\",\n          children: _jsx(_components.path, {\n            d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\",\n            fillRule: \"evenodd\"\n          })\n        })\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"**因特网控制报文协议(ICMP)**用于端系统和路由器之间沟通网络层的信息，典型用途是差错报告\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ICMP 是作为 IP 载荷所承载，但其位于网络层\\n\"\n    }), \"\\n\", _jsx(_components.img, {\n      src: \"/images/network/icmp_messages_type.webp\",\n      alt: \"icmp_messages_type\",\n      width: \"511\",\n      height: \"487\",\n      sizes: \"(max-width: 511px) 100vw, 487px\",\n      blurDataURL: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAIAAAAmkwkpAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAPUlEQVR4nGP49OF1Q32lt7ebt7cHw///v1qb642NDc3NTRj+//9bUlIoLy+rqqrM8PTpY29vD25edmlpSQB2+RTNQNe7mQAAAABJRU5ErkJggg==\",\n      placeholder: \"blur\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"\\n在 ICMPv6 中，添加了 IPv6 所需的类型和编码，如“分组太大”等\"\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"网络管理和-snmp\",\n      children: [\"网络管理和 SNMP\", _jsx(_components.a, {\n        className: \"anchor after\",\n        \"aria-hidden\": true,\n        \"aria-label\": \"permalink\",\n        tabIndex: \"-1\",\n        href: \"#网络管理和-snmp\",\n        children: _jsx(_components.svg, {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          viewBox: \"0 0 16 16\",\n          focusable: \"false\",\n          children: _jsx(_components.path, {\n            d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\",\n            fillRule: \"evenodd\"\n          })\n        })\n      })]\n    }), \"\\n\", _jsx(_components.p, {}), \"\\n\", _jsx(_components.img, {\n      src: \"/images/network/network_managed.webp\",\n      alt: \"network_managed\",\n      width: \"906\",\n      height: \"671\",\n      sizes: \"(max-width: 906px) 100vw, 671px\",\n      blurDataURL: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAIAAAA7ljmRAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAMklEQVR4nAEnANj/AElHRuHa07u2rxYSDgCln5X/9u65sKk+ODIAYllQwbSry7+1eW1hgNUT4gF7+eQAAAAASUVORK5CYII=\",\n      placeholder: \"blur\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"\\n\", _jsxs(_components.strong, {\n        children: [\"被管设备(managed device)\", _jsx(_components.strong, {\n          children: \"中的每个\"\n        }), \"被管对象(managed object, 如网卡/协议内容等)\", _jsx(_components.strong, {\n          children: \"通过\"\n        }), \"网络管理代理(network management agent)\", _jsx(_components.strong, {\n          children: \"与\"\n        }), \"管理服务器\"]\n      }), \"通信，之后被存储在**管理信息库(Management Information Base, MIB)**中\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"MIB 对象由数据描述语言 SMI(Structure of Management Information)所定义，收集在 MIB 模块中\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"代理和服务器之间使用\", _jsxs(_components.strong, {\n        children: [\"网络管理协议(network management protocol)\", _jsx(_components.strong, {\n          children: \"通信，典型的如\"\n        }), \"简单网络管理协议(Simple Network Management Protocol, SNMP)\"]\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"SNMP 是应用层协议其报文通常称为协议数据单元(PDU)，基于 UDP，通常有两种模式：① 请求响应，服务器请求，代理响应；② 异常陷阱，代理指示异常\\n\"\n    }), \"\\n\", _jsx(_components.img, {\n      src: \"/images/network/pdu_of_snmp.webp\",\n      alt: \"pdu_of_snmp\",\n      width: \"800\",\n      height: \"639\",\n      sizes: \"(max-width: 800px) 100vw, 639px\",\n      blurDataURL: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAIAAAA7ljmRAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAL0lEQVR4nGMQFBS0tbHYt2XV6zvnGSQlJaWlJE4e2Pn/0xMQh4uL7dDeTf9/vgMAHq0QwoprbgoAAAAASUVORK5CYII=\",\n      placeholder: \"blur\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = props.components || ({});\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  date,\n  title,\n  tags,\n  index,\n  default: MDXContent\n};\n","toc":[{"depth":2,"value":"路由选择算法","id":"路由选择算法"},{"depth":2,"value":"AS","id":"as"},{"depth":2,"value":"SDN 软件定义网络","id":"sdn-软件定义网络"},{"depth":2,"value":"ICMP","id":"icmp"},{"depth":2,"value":"网络管理和 SNMP","id":"网络管理和-snmp"}]},"overview":[{"length":21,"name":"archive"},{"length":15,"name":"graphics"},{"length":1,"name":"math"},{"length":8,"name":"network"}]},"__N_SSG":true},"page":"/[collection]/[...slug]","query":{"collection":"network","slug":["fifth"]},"buildId":"meNayWSLCpwIRBFSyCCZM","assetPrefix":"/blog","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>