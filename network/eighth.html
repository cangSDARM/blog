<!DOCTYPE html><html lang="cn"><head><meta charSet="UTF-8"/><title>第八章 | Network</title><meta name="viewport" content="width=device-width, initial-scale=1"/><meta property="og:title" content="第八章 | Network"/><meta name="description" content="Personal Blog"/><meta property="og:description" content="Personal Blog"/><meta property="og:type" content="website"/><meta property="twitter:card" content="summary_large_image"/><link rel="icon" type="image/x-icon" href="/favicon.ico"/><meta name="next-head-count" content="9"/><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/blog/_next/static/css/5f7c6aaf759aa20d.css" as="style"/><link rel="stylesheet" href="/blog/_next/static/css/5f7c6aaf759aa20d.css" data-n-g=""/><link rel="preload" href="/blog/_next/static/css/26ec16ccb915de94.css" as="style"/><link rel="stylesheet" href="/blog/_next/static/css/26ec16ccb915de94.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/blog/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/blog/_next/static/chunks/webpack-6965b024cefed38b.js" defer=""></script><script src="/blog/_next/static/chunks/framework-49c6cecf1f6d5795.js" defer=""></script><script src="/blog/_next/static/chunks/main-aa6243415bc34dcf.js" defer=""></script><script src="/blog/_next/static/chunks/pages/_app-ae897f29056b30d9.js" defer=""></script><script src="/blog/_next/static/chunks/29107295-2a9ca7f07685bf37.js" defer=""></script><script src="/blog/_next/static/chunks/117b9d7f-1415b8d5c023097d.js" defer=""></script><script src="/blog/_next/static/chunks/664-d254d21a6fe56bff.js" defer=""></script><script src="/blog/_next/static/chunks/475-f757a87f3cd5d391.js" defer=""></script><script src="/blog/_next/static/chunks/675-d64d4792f164bc88.js" defer=""></script><script src="/blog/_next/static/chunks/295-669440b57b4b1b5e.js" defer=""></script><script src="/blog/_next/static/chunks/pages/%5Bcollection%5D/%5B...slug%5D-7308aaad3bf994ab.js" defer=""></script><script src="/blog/_next/static/0afKTWA4-aQ1T3YyCw1HF/_buildManifest.js" defer=""></script><script src="/blog/_next/static/0afKTWA4-aQ1T3YyCw1HF/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header data-theme="dark" class="style_nav-root__jrAJR" style="height:80px"><section class="style_nav-section__sS_tB"><a class="style_nav-logo__jRYAT" href="/blog"><h3>Allen Lee@Blog</h3></a><nav aria-label="Main" data-orientation="horizontal" dir="ltr" class="style_nav-menus__4aQM9"><div style="position:relative"><ul data-orientation="horizontal" dir="ltr"><li><button class="style_btn__AkQj7 style_subtle__i70rQ style_nav-trigger__ekUye" id="radix-:Rj6:-trigger-radix-:Rjj6:" data-state="closed" aria-expanded="false" aria-controls="radix-:Rj6:-content-radix-:Rjj6:" data-radix-collection-item="">Overview <svg stroke="currentColor" fill="none" stroke-width="0" viewBox="0 0 15 15" aria-hidden="true" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.18179 6.18181C4.35753 6.00608 4.64245 6.00608 4.81819 6.18181L7.49999 8.86362L10.1818 6.18181C10.3575 6.00608 10.6424 6.00608 10.8182 6.18181C10.9939 6.35755 10.9939 6.64247 10.8182 6.81821L7.81819 9.81821C7.73379 9.9026 7.61934 9.95001 7.49999 9.95001C7.38064 9.95001 7.26618 9.9026 7.18179 9.81821L4.18179 6.81821C4.00605 6.64247 4.00605 6.35755 4.18179 6.18181Z" fill="currentColor"></path></svg></button></li></ul></div></nav></section></header><main data-theme="light" style="background-color:var(--colorNeutralBackground1);overflow-x:hidden;overflow-y:auto;width:100vw;height:calc(100vh - 80px)" id="main"><div class="collection_slug_Root__xztwf"><div class="styles_netPost__eLnJE" style="max-width:960px;font-family:YaHei, Helvetica, arial, sans-serif;font-size:16px"><h1>第八章</h1><h2 id="机密性">机密性<a class="anchor after" aria-hidden="true" aria-label="permalink" tabindex="-1" href="/blog/network/eighth#%E6%9C%BA%E5%AF%86%E6%80%A7"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" focusable="false"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a></h2>
<p>按照攻击者的信息，攻击有三种情况</p>
<ol>
<li><em>唯密文攻击(ciphertext-only attack)</em>，攻击者只知道密文</li>
<li><em>已知密文攻击(known-plaintext attack)</em>，攻击者知道密文必定携带的一些信息</li>
<li><em>选择明文攻击(chosen-plaintext attack)</em>，攻击者能够让加密者发送特定的明文</li>
</ol>
<p>对称加密技术有两种类型：<strong>流密码(stream cipher)<strong>和</strong>块密码(block cipher)</strong></p>
<p>块密码将加密报文分为 k 块，每块被单独加密。其通常使用函数模拟随机排列表生成，如<strong>DES(Data Encryption Standard)</strong>、<strong>3DES</strong>、<strong>ADS(Advanced Encryption Standard)</strong>
</p>
<figure role="figure"><span class="resp-image-wrapper" style="display:flex;align-items:center;justify-content:center;position:relative"><a target="_blank" rel="noopener" style="display:block" href="/blog/images/network/block_cipher_sample.webp"><img crossorigin="anonymous" alt="block_cipher_sample" loading="lazy" width="631" height="433" decoding="async" data-nimg="1" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 631 433&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAIAAAA7ljmRAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAL0lEQVR4nGP4+f+/h6OlqbaitYkaw97jZzWVZBQl+U21FRlae3qFOBjEuRlMtRUBCSQKrf3v5gMAAAAASUVORK5CYII=&#x27;/%3E%3C/svg%3E&quot;)" src="/blog/images/network/block_cipher_sample.webp"/></a></span><figcaption role="figcaption">block_cipher_sample</figcaption></figure>
<p>
由于块密码采用函数，因此输入总对应同一输出，因此需要引入随机值，但随机需要传输更多比特，因此有<strong>密码块链接(Cipher Block Chaining, CBC)技术</strong></p>
<ul>
<li>发送加密内容前，发送方生成随机的 k 比特<strong>初始向量(Initialization Vector, IV)</strong>(c(0))，以明文方式发送</li>
<li>对于传输加密块 c(i)，c(i)=K(m(i)⊕c(i-1))，其中 K 表示块加密函数，m(i)表示第 i 个明文，c(i-1)是上次传输的加密块</li>
</ul>
<p>由于分发对称密钥困难，因此有非对称密钥体系，如公钥私钥体系，如<strong>RSA 算法</strong></p>
<p>但 RSA 算法复杂，因此通信时仍采用对称密钥，而使用非对称密钥加密对称密钥(称为<strong>会话密钥</strong>)，并在每次发送数据时变动(发送会话密钥和数据)</p>
<h2 id="报文完整性">报文完整性<a class="anchor after" aria-hidden="true" aria-label="permalink" tabindex="-1" href="/blog/network/eighth#%E6%8A%A5%E6%96%87%E5%AE%8C%E6%95%B4%E6%80%A7"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" focusable="false"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a></h2>
<p><strong>密码散列函数(cryptographic hash function)<strong>将 m 作为输入，并得到一个固定长度字符串 H(m)。其中，对于报文 x 和 y，其散列函数 H(x)=H(y)，当且仅当 x=y 成立。典型的如</strong>MD5</strong>、<strong>SHA-1</strong></p>
<p>**报文完整性(message integrity)**用于鉴别来源和非篡改</p>
<ol>
<li>使用<strong>报文鉴别码(Message Authentication Code, MAC)</strong>。<!-- -->
<ul>
<li>发送方生成报文 m，用**鉴别密钥(authentication key)**s(双方已知)级联 m，并计算其散列函数 H(m+s) 即 MAC</li>
<li>发送方将 MAC 附加到报文 m 上，形成扩展报文(m, H(m+s))发送</li>
<li>接收方接收，由于知道 s，因此计算出 H(m+s)，如果计算和发送结果相同，则一切正常</li>
</ul>
</li>
<li>使用<strong>数字签名(digital signature)</strong>。<!-- -->
<ul>
<li>发送方对报文 m 使用私钥加密，生成签名 RSA(m)(因为 RSA 性质，私钥(公钥(m))=公钥(私钥(m))=m，因此可行)</li>
<li>发送方将签名附加到报文 m 上，形成扩展报文(m, RSA(m))发送</li>
<li>接收方使用发送方的公钥计算，如果计算公钥(私钥(m))=m，则一切正常</li>
</ul>
</li>
<li>混合 MAC 和签名(RSA 太复杂所致)<!-- -->
<ul>
<li>发送方对 MAC 进行私钥加密</li>
<li>发送扩展报文</li>
<li>接收方验证</li>
</ul>
</li>
</ol>
<h2 id="端点鉴别">端点鉴别<a class="anchor after" aria-hidden="true" aria-label="permalink" tabindex="-1" href="/blog/network/eighth#%E7%AB%AF%E7%82%B9%E9%89%B4%E5%88%AB"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" focusable="false"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a></h2>
<p>**端点鉴别(end-point authentication)**用于表明实体身份确实是其声称的那样</p>
<p>典型的有<strong>公钥认证(public key certification)</strong>，其使用**CA(Certification Authority, 认证中心)**颁发数字签名实现</p>
<p>**PGP(Pretty Good Privacy)**是一类用于消息加密、验证的应用程序的统称</p>
<h2 id="传输层安全性-ssl">传输层安全性: SSL<a class="anchor after" aria-hidden="true" aria-label="permalink" tabindex="-1" href="/blog/network/eighth#%E4%BC%A0%E8%BE%93%E5%B1%82%E5%AE%89%E5%85%A8%E6%80%A7-ssl"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" focusable="false"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a></h2>
<p><strong>SSL(Secure Socket Layer, 安全套接字层)<strong>是 TCP 的一个强化版本，SSL3 的一个稍加修改的版本称为</strong>运输层安全性(Transport Layer Security, TLS)</strong>
</p>
<figure role="figure"><span class="resp-image-wrapper" style="display:flex;align-items:center;justify-content:center;position:relative"><a target="_blank" rel="noopener" style="display:block" href="/blog/images/network/ssl.webp"><img crossorigin="anonymous" alt="ssl" loading="lazy" width="753" height="538" decoding="async" data-nimg="1" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 753 538&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAIAAAA7ljmRAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAMklEQVR4nAEnANj/AIaDffjz7hEOCPj59QAsKiTg29UiIB/x7+wAgn97fnl2YF1cmpiVhmYTbSvaXxkAAAAASUVORK5CYII=&#x27;/%3E%3C/svg%3E&quot;)" src="/blog/images/network/ssl.webp"/></a></span><figcaption role="figcaption">ssl</figcaption></figure>
<p>
SSL 具有三个阶段</p>
<ol>
<li>握手。<!-- -->
<ul>
<li>TCP 三次握手</li>
<li>客户端发送其支持的密码算法列表(明文)，和一个不重数(防止<strong>重放攻击(replay attack)</strong>)</li>
<li>服务器从列表中选择对称算法、公钥算法和 MAC 算法各一种。将选择、证书和一个不重数返回</li>
<li>客户端验证证书，提取服务器公钥并生成一个<strong>前主密钥(Pre-Master Secret, PMS)</strong>，并用服务器公钥加密 PMS 发送</li>
<li>使用相同的密钥导出函数，客户端和服务端独立的从 PMS 和不重数计算出<strong>主密钥(Master Secret, MS)</strong></li>
</ul>
</li>
<li>密钥导出<!-- -->
<ul>
<li>对 MS 切片，生成来回单独使用的加密密钥和 MAC 密钥，共 4 个密钥</li>
<li>客户端发送所有握手报文的一个 MAC，服务端也同样发送所有握手报文的一个 MAC(防止篡改之前的握手环节报文)</li>
</ul>
</li>
<li>数据传输<!-- -->
<ul>
<li>SSL 将数据流分割为<em>记录</em>，用&quot;数据+MAC 密钥+序号(防止重排序)&quot;生成 MACs，并加密&quot;记录+对应 MACs&quot;，然后填充给 TCP 传输
<!-- -->
<figure role="figure"><span class="resp-image-wrapper" style="display:flex;align-items:center;justify-content:center;position:relative"><a target="_blank" rel="noopener" style="display:block" href="/blog/images/network/ssl_format.webp"><img crossorigin="anonymous" alt="ssl_format" loading="lazy" width="1180" height="398" decoding="async" data-nimg="1" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 1180 398&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABCAIAAAB2XpiaAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAFklEQVR4nGPgY2E4e+Lg39+/3rx5AwAn4ggfCao6YgAAAABJRU5ErkJggg==&#x27;/%3E%3C/svg%3E&quot;)" src="/blog/images/network/ssl_format.webp"/></a></span><figcaption role="figcaption">ssl_format</figcaption></figure>
<!-- -->
SSL 关闭要么超时，要么使用类型字段表明终止(不使用 TCP FIN，防止<strong>截断攻击(truncation attack)</strong>)。该字段为明文，但使用 MAC 验证</li>
</ul>
</li>
</ol>
<h2 id="网络层安全性-ipsec-和虚拟专用网">网络层安全性: IPsec 和虚拟专用网<a class="anchor after" aria-hidden="true" aria-label="permalink" tabindex="-1" href="/blog/network/eighth#%E7%BD%91%E7%BB%9C%E5%B1%82%E5%AE%89%E5%85%A8%E6%80%A7-ipsec-%E5%92%8C%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E7%BD%91"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" focusable="false"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a></h2>
<p><strong>IP 安全(IP Security, IPsec)协议簇</strong>用于向 IP 数据报提供安全，**虚拟专用网(Vitual Private Network, VPN)**建于其上</p>
<p>某 IPsec 实体发送安全数据报时，可以使用<strong>AH(Authentication Header, 鉴别首部)协议</strong>或<strong>ESP(Encapsulation Security Payload, ESP)协议</strong>做到，但 AH 只提供源鉴别和完整性服务，ESP 还能加密，因此之后讨论关注于 ESP</p>
<p>在发送 IPsec 前，端系统需要建立一个网络层的单工逻辑连接称为<strong>安全关联(Security Association, SA)</strong>。其维护了如 SA 的 32 比特索引(<strong>安全参数索引(Security Parameter Index, SPI)</strong>)、初始地址及目标地址、加密类型和密钥。所有的 SA 被维护于**安全关联数据库(Security Association Database, SAD)**中</p>
<p>SA 可由人工生成或使用**因特网密钥交换(Internet Key Exchange, IKE)**协议生成
</p>
<figure role="figure"><span class="resp-image-wrapper" style="display:flex;align-items:center;justify-content:center;position:relative"><a target="_blank" rel="noopener" style="display:block" href="/blog/images/network/ipsec_message_esp_format.webp"><img crossorigin="anonymous" alt="ipsec_message_esp_format" loading="lazy" width="1375" height="586" decoding="async" data-nimg="1" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 1375 586&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAACCAIAAADwyuo0AAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAJUlEQVR4nAEaAOX/AP/8+d/d183HwoR+dQC2saz//PTBt7AQAwD2oxCSaT0ZdQAAAABJRU5ErkJggg==&#x27;/%3E%3C/svg%3E&quot;)" src="/blog/images/network/ipsec_message_esp_format.webp"/></a></span><figcaption role="figcaption">ipsec_message_esp_format</figcaption></figure>
<h2 id="无线传输安全-wep">无线传输安全: WEP<a class="anchor after" aria-hidden="true" aria-label="permalink" tabindex="-1" href="/blog/network/eighth#%E6%97%A0%E7%BA%BF%E4%BC%A0%E8%BE%93%E5%AE%89%E5%85%A8-wep"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" focusable="false"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a></h2>
<p>**WEP(Wired Equivalent Privacy, 有线等效保密)**是 802.11 标准化的安全性规范，(后来还有安全性更好的 802.11i)</p>
<p>WEP 要求鉴别方式如下进行</p>
<ul>
<li>主机和 AP 以其他方式确认了密钥</li>
<li>主机请求鉴别</li>
<li>AP 返回一个 128 字节不重数响应</li>
<li>主机使用密钥加密该不重数并返回</li>
<li>AP 解密。若发送和接受的值相同则通过鉴别</li>
</ul>
<h2 id="看书">看书<a class="anchor after" aria-hidden="true" aria-label="permalink" tabindex="-1" href="/blog/network/eighth#%E7%9C%8B%E4%B9%A6"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" focusable="false"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a></h2></div></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"matter":{"date":"2018-01-30","title":"第八章","tags":["network"],"index":8},"absPath":"/home/runner/work/blog/blog/renderer/mdx/network/eighth.mdx","type":"mdx","slug":["eighth"],"collection":"network","url":"/network/eighth"},"compiled":{"content":"\"use strict\";\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst frontmatter = {\n  \"date\": \"2018-01-30\",\n  \"title\": \"第八章\",\n  \"tags\": [\"network\"],\n  \"index\": 8\n};\nfunction _createMdxContent(props) {\n  const _components = {\n    a: \"a\",\n    em: \"em\",\n    h2: \"h2\",\n    img: \"img\",\n    li: \"li\",\n    ol: \"ol\",\n    p: \"p\",\n    path: \"path\",\n    strong: \"strong\",\n    svg: \"svg\",\n    ul: \"ul\",\n    ...props.components\n  };\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.h2, {\n      id: \"机密性\",\n      children: [\"机密性\", _jsx(_components.a, {\n        className: \"anchor after\",\n        \"aria-hidden\": true,\n        \"aria-label\": \"permalink\",\n        tabIndex: \"-1\",\n        href: \"#机密性\",\n        children: _jsx(_components.svg, {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          viewBox: \"0 0 16 16\",\n          focusable: \"false\",\n          children: _jsx(_components.path, {\n            d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\",\n            fillRule: \"evenodd\"\n          })\n        })\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"按照攻击者的信息，攻击有三种情况\"\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.em, {\n          children: \"唯密文攻击(ciphertext-only attack)\"\n        }), \"，攻击者只知道密文\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.em, {\n          children: \"已知密文攻击(known-plaintext attack)\"\n        }), \"，攻击者知道密文必定携带的一些信息\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.em, {\n          children: \"选择明文攻击(chosen-plaintext attack)\"\n        }), \"，攻击者能够让加密者发送特定的明文\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"对称加密技术有两种类型：\", _jsxs(_components.strong, {\n        children: [\"流密码(stream cipher)\", _jsx(_components.strong, {\n          children: \"和\"\n        }), \"块密码(block cipher)\"]\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"块密码将加密报文分为 k 块，每块被单独加密。其通常使用函数模拟随机排列表生成，如\", _jsx(_components.strong, {\n        children: \"DES(Data Encryption Standard)\"\n      }), \"、\", _jsx(_components.strong, {\n        children: \"3DES\"\n      }), \"、\", _jsx(_components.strong, {\n        children: \"ADS(Advanced Encryption Standard)\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.img, {\n      src: \"/images/network/block_cipher_sample.webp\",\n      alt: \"block_cipher_sample\",\n      width: \"631\",\n      height: \"433\",\n      sizes: \"(max-width: 631px) 100vw, 433px\",\n      blurDataURL: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAIAAAA7ljmRAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAL0lEQVR4nGP4+f+/h6OlqbaitYkaw97jZzWVZBQl+U21FRlae3qFOBjEuRlMtRUBCSQKrf3v5gMAAAAASUVORK5CYII=\",\n      placeholder: \"blur\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"\\n由于块密码采用函数，因此输入总对应同一输出，因此需要引入随机值，但随机需要传输更多比特，因此有\", _jsx(_components.strong, {\n        children: \"密码块链接(Cipher Block Chaining, CBC)技术\"\n      })]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"发送加密内容前，发送方生成随机的 k 比特\", _jsx(_components.strong, {\n          children: \"初始向量(Initialization Vector, IV)\"\n        }), \"(c(0))，以明文方式发送\"]\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"对于传输加密块 c(i)，c(i)=K(m(i)⊕c(i-1))，其中 K 表示块加密函数，m(i)表示第 i 个明文，c(i-1)是上次传输的加密块\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"由于分发对称密钥困难，因此有非对称密钥体系，如公钥私钥体系，如\", _jsx(_components.strong, {\n        children: \"RSA 算法\"\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"但 RSA 算法复杂，因此通信时仍采用对称密钥，而使用非对称密钥加密对称密钥(称为\", _jsx(_components.strong, {\n        children: \"会话密钥\"\n      }), \")，并在每次发送数据时变动(发送会话密钥和数据)\"]\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"报文完整性\",\n      children: [\"报文完整性\", _jsx(_components.a, {\n        className: \"anchor after\",\n        \"aria-hidden\": true,\n        \"aria-label\": \"permalink\",\n        tabIndex: \"-1\",\n        href: \"#报文完整性\",\n        children: _jsx(_components.svg, {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          viewBox: \"0 0 16 16\",\n          focusable: \"false\",\n          children: _jsx(_components.path, {\n            d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\",\n            fillRule: \"evenodd\"\n          })\n        })\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsxs(_components.strong, {\n        children: [\"密码散列函数(cryptographic hash function)\", _jsx(_components.strong, {\n          children: \"将 m 作为输入，并得到一个固定长度字符串 H(m)。其中，对于报文 x 和 y，其散列函数 H(x)=H(y)，当且仅当 x=y 成立。典型的如\"\n        }), \"MD5\"]\n      }), \"、\", _jsx(_components.strong, {\n        children: \"SHA-1\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"**报文完整性(message integrity)**用于鉴别来源和非篡改\"\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"使用\", _jsx(_components.strong, {\n          children: \"报文鉴别码(Message Authentication Code, MAC)\"\n        }), \"。\", \"\\n\", _jsxs(_components.ul, {\n          children: [\"\\n\", _jsx(_components.li, {\n            children: \"发送方生成报文 m，用**鉴别密钥(authentication key)**s(双方已知)级联 m，并计算其散列函数 H(m+s) 即 MAC\"\n          }), \"\\n\", _jsx(_components.li, {\n            children: \"发送方将 MAC 附加到报文 m 上，形成扩展报文(m, H(m+s))发送\"\n          }), \"\\n\", _jsx(_components.li, {\n            children: \"接收方接收，由于知道 s，因此计算出 H(m+s)，如果计算和发送结果相同，则一切正常\"\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"使用\", _jsx(_components.strong, {\n          children: \"数字签名(digital signature)\"\n        }), \"。\", \"\\n\", _jsxs(_components.ul, {\n          children: [\"\\n\", _jsx(_components.li, {\n            children: \"发送方对报文 m 使用私钥加密，生成签名 RSA(m)(因为 RSA 性质，私钥(公钥(m))=公钥(私钥(m))=m，因此可行)\"\n          }), \"\\n\", _jsx(_components.li, {\n            children: \"发送方将签名附加到报文 m 上，形成扩展报文(m, RSA(m))发送\"\n          }), \"\\n\", _jsx(_components.li, {\n            children: \"接收方使用发送方的公钥计算，如果计算公钥(私钥(m))=m，则一切正常\"\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"混合 MAC 和签名(RSA 太复杂所致)\", \"\\n\", _jsxs(_components.ul, {\n          children: [\"\\n\", _jsx(_components.li, {\n            children: \"发送方对 MAC 进行私钥加密\"\n          }), \"\\n\", _jsx(_components.li, {\n            children: \"发送扩展报文\"\n          }), \"\\n\", _jsx(_components.li, {\n            children: \"接收方验证\"\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"端点鉴别\",\n      children: [\"端点鉴别\", _jsx(_components.a, {\n        className: \"anchor after\",\n        \"aria-hidden\": true,\n        \"aria-label\": \"permalink\",\n        tabIndex: \"-1\",\n        href: \"#端点鉴别\",\n        children: _jsx(_components.svg, {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          viewBox: \"0 0 16 16\",\n          focusable: \"false\",\n          children: _jsx(_components.path, {\n            d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\",\n            fillRule: \"evenodd\"\n          })\n        })\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"**端点鉴别(end-point authentication)**用于表明实体身份确实是其声称的那样\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"典型的有\", _jsx(_components.strong, {\n        children: \"公钥认证(public key certification)\"\n      }), \"，其使用**CA(Certification Authority, 认证中心)**颁发数字签名实现\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"**PGP(Pretty Good Privacy)**是一类用于消息加密、验证的应用程序的统称\"\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"传输层安全性-ssl\",\n      children: [\"传输层安全性: SSL\", _jsx(_components.a, {\n        className: \"anchor after\",\n        \"aria-hidden\": true,\n        \"aria-label\": \"permalink\",\n        tabIndex: \"-1\",\n        href: \"#传输层安全性-ssl\",\n        children: _jsx(_components.svg, {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          viewBox: \"0 0 16 16\",\n          focusable: \"false\",\n          children: _jsx(_components.path, {\n            d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\",\n            fillRule: \"evenodd\"\n          })\n        })\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsxs(_components.strong, {\n        children: [\"SSL(Secure Socket Layer, 安全套接字层)\", _jsx(_components.strong, {\n          children: \"是 TCP 的一个强化版本，SSL3 的一个稍加修改的版本称为\"\n        }), \"运输层安全性(Transport Layer Security, TLS)\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.img, {\n      src: \"/images/network/ssl.webp\",\n      alt: \"ssl\",\n      width: \"753\",\n      height: \"538\",\n      sizes: \"(max-width: 753px) 100vw, 538px\",\n      blurDataURL: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAIAAAA7ljmRAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAMklEQVR4nAEnANj/AIaDffjz7hEOCPj59QAsKiTg29UiIB/x7+wAgn97fnl2YF1cmpiVhmYTbSvaXxkAAAAASUVORK5CYII=\",\n      placeholder: \"blur\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"\\nSSL 具有三个阶段\"\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"握手。\", \"\\n\", _jsxs(_components.ul, {\n          children: [\"\\n\", _jsx(_components.li, {\n            children: \"TCP 三次握手\"\n          }), \"\\n\", _jsxs(_components.li, {\n            children: [\"客户端发送其支持的密码算法列表(明文)，和一个不重数(防止\", _jsx(_components.strong, {\n              children: \"重放攻击(replay attack)\"\n            }), \")\"]\n          }), \"\\n\", _jsx(_components.li, {\n            children: \"服务器从列表中选择对称算法、公钥算法和 MAC 算法各一种。将选择、证书和一个不重数返回\"\n          }), \"\\n\", _jsxs(_components.li, {\n            children: [\"客户端验证证书，提取服务器公钥并生成一个\", _jsx(_components.strong, {\n              children: \"前主密钥(Pre-Master Secret, PMS)\"\n            }), \"，并用服务器公钥加密 PMS 发送\"]\n          }), \"\\n\", _jsxs(_components.li, {\n            children: [\"使用相同的密钥导出函数，客户端和服务端独立的从 PMS 和不重数计算出\", _jsx(_components.strong, {\n              children: \"主密钥(Master Secret, MS)\"\n            })]\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"密钥导出\", \"\\n\", _jsxs(_components.ul, {\n          children: [\"\\n\", _jsx(_components.li, {\n            children: \"对 MS 切片，生成来回单独使用的加密密钥和 MAC 密钥，共 4 个密钥\"\n          }), \"\\n\", _jsx(_components.li, {\n            children: \"客户端发送所有握手报文的一个 MAC，服务端也同样发送所有握手报文的一个 MAC(防止篡改之前的握手环节报文)\"\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"数据传输\", \"\\n\", _jsxs(_components.ul, {\n          children: [\"\\n\", _jsxs(_components.li, {\n            children: [\"SSL 将数据流分割为\", _jsx(_components.em, {\n              children: \"记录\"\n            }), \"，用\\\"数据+MAC 密钥+序号(防止重排序)\\\"生成 MACs，并加密\\\"记录+对应 MACs\\\"，然后填充给 TCP 传输\\n\", \"\\n\", _jsx(_components.img, {\n              src: \"/images/network/ssl_format.webp\",\n              alt: \"ssl_format\",\n              width: \"1180\",\n              height: \"398\",\n              sizes: \"(max-width: 1180px) 100vw, 398px\",\n              blurDataURL: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABCAIAAAB2XpiaAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAFklEQVR4nGPgY2E4e+Lg39+/3rx5AwAn4ggfCao6YgAAAABJRU5ErkJggg==\",\n              placeholder: \"blur\"\n            }), \"\\n\", \"\\nSSL 关闭要么超时，要么使用类型字段表明终止(不使用 TCP FIN，防止\", _jsx(_components.strong, {\n              children: \"截断攻击(truncation attack)\"\n            }), \")。该字段为明文，但使用 MAC 验证\"]\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"网络层安全性-ipsec-和虚拟专用网\",\n      children: [\"网络层安全性: IPsec 和虚拟专用网\", _jsx(_components.a, {\n        className: \"anchor after\",\n        \"aria-hidden\": true,\n        \"aria-label\": \"permalink\",\n        tabIndex: \"-1\",\n        href: \"#网络层安全性-ipsec-和虚拟专用网\",\n        children: _jsx(_components.svg, {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          viewBox: \"0 0 16 16\",\n          focusable: \"false\",\n          children: _jsx(_components.path, {\n            d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\",\n            fillRule: \"evenodd\"\n          })\n        })\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"IP 安全(IP Security, IPsec)协议簇\"\n      }), \"用于向 IP 数据报提供安全，**虚拟专用网(Vitual Private Network, VPN)**建于其上\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"某 IPsec 实体发送安全数据报时，可以使用\", _jsx(_components.strong, {\n        children: \"AH(Authentication Header, 鉴别首部)协议\"\n      }), \"或\", _jsx(_components.strong, {\n        children: \"ESP(Encapsulation Security Payload, ESP)协议\"\n      }), \"做到，但 AH 只提供源鉴别和完整性服务，ESP 还能加密，因此之后讨论关注于 ESP\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"在发送 IPsec 前，端系统需要建立一个网络层的单工逻辑连接称为\", _jsx(_components.strong, {\n        children: \"安全关联(Security Association, SA)\"\n      }), \"。其维护了如 SA 的 32 比特索引(\", _jsx(_components.strong, {\n        children: \"安全参数索引(Security Parameter Index, SPI)\"\n      }), \")、初始地址及目标地址、加密类型和密钥。所有的 SA 被维护于**安全关联数据库(Security Association Database, SAD)**中\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"SA 可由人工生成或使用**因特网密钥交换(Internet Key Exchange, IKE)**协议生成\\n\"\n    }), \"\\n\", _jsx(_components.img, {\n      src: \"/images/network/ipsec_message_esp_format.webp\",\n      alt: \"ipsec_message_esp_format\",\n      width: \"1375\",\n      height: \"586\",\n      sizes: \"(max-width: 1375px) 100vw, 586px\",\n      blurDataURL: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAACCAIAAADwyuo0AAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAJUlEQVR4nAEaAOX/AP/8+d/d183HwoR+dQC2saz//PTBt7AQAwD2oxCSaT0ZdQAAAABJRU5ErkJggg==\",\n      placeholder: \"blur\"\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"无线传输安全-wep\",\n      children: [\"无线传输安全: WEP\", _jsx(_components.a, {\n        className: \"anchor after\",\n        \"aria-hidden\": true,\n        \"aria-label\": \"permalink\",\n        tabIndex: \"-1\",\n        href: \"#无线传输安全-wep\",\n        children: _jsx(_components.svg, {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          viewBox: \"0 0 16 16\",\n          focusable: \"false\",\n          children: _jsx(_components.path, {\n            d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\",\n            fillRule: \"evenodd\"\n          })\n        })\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"**WEP(Wired Equivalent Privacy, 有线等效保密)**是 802.11 标准化的安全性规范，(后来还有安全性更好的 802.11i)\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"WEP 要求鉴别方式如下进行\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"主机和 AP 以其他方式确认了密钥\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"主机请求鉴别\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"AP 返回一个 128 字节不重数响应\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"主机使用密钥加密该不重数并返回\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"AP 解密。若发送和接受的值相同则通过鉴别\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"看书\",\n      children: [\"看书\", _jsx(_components.a, {\n        className: \"anchor after\",\n        \"aria-hidden\": true,\n        \"aria-label\": \"permalink\",\n        tabIndex: \"-1\",\n        href: \"#看书\",\n        children: _jsx(_components.svg, {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          viewBox: \"0 0 16 16\",\n          focusable: \"false\",\n          children: _jsx(_components.path, {\n            d: \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\",\n            fillRule: \"evenodd\"\n          })\n        })\n      })]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = props.components || ({});\n  return MDXLayout ? _jsx(MDXLayout, {\n    ...props,\n    children: _jsx(_createMdxContent, {\n      ...props\n    })\n  }) : _createMdxContent(props);\n}\nreturn {\n  frontmatter,\n  default: MDXContent\n};\n","toc":[{"depth":2,"value":"机密性","id":"机密性"},{"depth":2,"value":"报文完整性","id":"报文完整性"},{"depth":2,"value":"端点鉴别","id":"端点鉴别"},{"depth":2,"value":"传输层安全性: SSL","id":"传输层安全性-ssl"},{"depth":2,"value":"网络层安全性: IPsec 和虚拟专用网","id":"网络层安全性-ipsec-和虚拟专用网"},{"depth":2,"value":"无线传输安全: WEP","id":"无线传输安全-wep"},{"depth":2,"value":"看书","id":"看书"}]},"overview":[{"length":22,"name":"archive"},{"length":15,"name":"graphics"},{"length":1,"name":"math"},{"length":8,"name":"network"},{"length":2,"name":"sstory"}]},"__N_SSG":true},"page":"/[collection]/[...slug]","query":{"collection":"network","slug":["eighth"]},"buildId":"0afKTWA4-aQ1T3YyCw1HF","assetPrefix":"/blog","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>